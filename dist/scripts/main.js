"use strict";var width=20,height=20,frameLength=100,startX=2,startY=2,startLength=80,throughWalls=!0,snakeColour="#2B3E51",SNAKE={},touchEl=document.querySelector(".touch"),hammertime=new Hammer.Manager(touchEl);hammertime.add(new Hammer.Swipe({direction:Hammer.DIRECTION_ALL})),SNAKE.game=function(){function t(){n.clearRect(0,0,width,height),a.advance(),a.check()?r():(a.draw(n),setTimeout(t,frameLength))}function e(){var t={37:"left",38:"up",39:"right",40:"down"},e={2:"left",4:"right",8:"up",16:"down"};document.onkeydown=function(e){var n=e.which,i=t[n];i?(a.setDirection(i),e.preventDefault()):32===n&&r()},hammertime.on("swipe",function(t){t.preventDefault();var r=e[t.direction];r&&a.setDirection(r)})}function r(){var r=document.querySelector("canvas.snake");r.width=width,r.height=height,n=r.getContext("2d"),a=SNAKE.snake(),e(),t()}var n,a;return{init:r}}(),SNAKE.snake=function(){function t(t){var e;switch(s){case"left":case"right":e=["up","down"];break;case"up":case"down":e=["left","right"];break;default:throw"Invalid direction"}e.indexOf(t)>-1?f=t:d=t}function e(t,e){var r=e[0],n=e[1];t.fillRect(r,n,1,1)}function r(t){t.save(),t.fillStyle=snakeColour;for(var r=0;r<h.length;r++)e(t,h[r]);t.restore()}function n(t,e){return(t%e+e)%e}function a(){var e=h[0].slice();switch(s=f,d&&(t(d),d=void 0),s){case"left":e[0]-=1;break;case"up":e[1]-=1;break;case"right":e[0]+=1;break;case"down":e[1]+=1;break;default:throw"Invalid direction"}throughWalls&&(e[0]=n(e[0],width),e[1]=n(e[1],height)),h.unshift(e),h.pop()}function i(t,e){var r=t[0]===e[0]&&t[1]===e[1];return r}function c(t,e){var r=!1;return e.forEach(function(e){i(t,e)&&(r=!0)}),r}function o(){var t=!1,e=h[0],r=h.slice(1,-1),n=e[0],a=e[1];return t=!throughWalls&&0>n||n>=width||0>a||a>=height?!0:t,t=c(e,r)?!0:t}for(var h=[],u=0;startLength>u;u++)h.push([startX,startY-u]);var s="right",f=s,d=f;return{draw:r,advance:a,setDirection:t,check:o}},SNAKE.game.init();